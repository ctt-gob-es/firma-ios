//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/desarrolloabamobile/Documents/JAVA/pades-ios/src/main/java/org/spongycastle/math/ec/WTauNafMultiplier.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/math/BigInteger.h"
#include "org/spongycastle/math/ec/AbstractECMultiplier.h"
#include "org/spongycastle/math/ec/ECCurve.h"
#include "org/spongycastle/math/ec/ECFieldElement.h"
#include "org/spongycastle/math/ec/ECPoint.h"
#include "org/spongycastle/math/ec/PreCompInfo.h"
#include "org/spongycastle/math/ec/Tnaf.h"
#include "org/spongycastle/math/ec/WTauNafMultiplier.h"
#include "org/spongycastle/math/ec/WTauNafPreCompInfo.h"
#include "org/spongycastle/math/ec/ZTauElement.h"

#if !__has_feature(objc_arc)
#error "org/spongycastle/math/ec/WTauNafMultiplier must be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgSpongycastleMathEcWTauNafMultiplier ()

/*!
 @brief Multiplies a <code>ECPoint.AbstractF2m</code>
  by an element <code>&lambda;</code> of <code><b>Z</b>[&tau;]</code> using
  the <code>&tau;</code>-adic NAF (TNAF) method.
 @param p The ECPoint.AbstractF2m to multiply.
 @param lambda The element  <code> &lambda; </code>  of   <code> <b> Z </b> [ &tau; ] </code>  of which to compute the   <code> [ &tau; ] </code> -adic NAF.
 @return <code>p</code> multiplied by <code>&lambda;</code>.
 */
- (OrgSpongycastleMathEcECPoint_AbstractF2m *)multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m:(OrgSpongycastleMathEcECPoint_AbstractF2m *)p
                                                                   withOrgSpongycastleMathEcZTauElement:(OrgSpongycastleMathEcZTauElement *)lambda
                                                                   withOrgSpongycastleMathEcPreCompInfo:(id<OrgSpongycastleMathEcPreCompInfo>)preCompInfo
                                                                                               withByte:(jbyte)a
                                                                                               withByte:(jbyte)mu;

/*!
 @brief Multiplies a <code>ECPoint.AbstractF2m</code>
  by an element <code>&lambda;</code> of <code><b>Z</b>[&tau;]</code>
  using the window <code>&tau;</code>-adic NAF (TNAF) method, given the
  WTNAF of <code>&lambda;</code>.
 @param p The ECPoint.AbstractF2m to multiply.
 @param u The the WTNAF of  <code> &lambda; </code> ..
 @return <code>&lambda; * p</code>
 */
+ (OrgSpongycastleMathEcECPoint_AbstractF2m *)multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m:(OrgSpongycastleMathEcECPoint_AbstractF2m *)p
                                                                                              withByteArray:(IOSByteArray *)u
                                                                       withOrgSpongycastleMathEcPreCompInfo:(id<OrgSpongycastleMathEcPreCompInfo>)preCompInfo;

@end

__attribute__((unused)) static OrgSpongycastleMathEcECPoint_AbstractF2m *OrgSpongycastleMathEcWTauNafMultiplier_multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withOrgSpongycastleMathEcZTauElement_withOrgSpongycastleMathEcPreCompInfo_withByte_withByte_(OrgSpongycastleMathEcWTauNafMultiplier *self, OrgSpongycastleMathEcECPoint_AbstractF2m *p, OrgSpongycastleMathEcZTauElement *lambda, id<OrgSpongycastleMathEcPreCompInfo> preCompInfo, jbyte a, jbyte mu);

__attribute__((unused)) static OrgSpongycastleMathEcECPoint_AbstractF2m *OrgSpongycastleMathEcWTauNafMultiplier_multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withByteArray_withOrgSpongycastleMathEcPreCompInfo_(OrgSpongycastleMathEcECPoint_AbstractF2m *p, IOSByteArray *u, id<OrgSpongycastleMathEcPreCompInfo> preCompInfo);

#line 1 "/Users/desarrolloabamobile/Documents/JAVA/pades-ios/src/main/java/org/spongycastle/math/ec/WTauNafMultiplier.java"

NSString *OrgSpongycastleMathEcWTauNafMultiplier_PRECOMP_NAME = @"bc_wtnaf";


#line 9
@implementation OrgSpongycastleMathEcWTauNafMultiplier

J2OBJC_IGNORE_DESIGNATED_BEGIN

#line 9
- (instancetype)init {
  OrgSpongycastleMathEcWTauNafMultiplier_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END


#line 22
- (OrgSpongycastleMathEcECPoint *)multiplyPositiveWithOrgSpongycastleMathEcECPoint:(OrgSpongycastleMathEcECPoint *)point
                                                            withJavaMathBigInteger:(JavaMathBigInteger *)k {
  if (!([point isKindOfClass:[OrgSpongycastleMathEcECPoint_AbstractF2m class]])) {
    
#line 26
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Only ECPoint.AbstractF2m can be used in WTauNafMultiplier");
  }
  
#line 30
  OrgSpongycastleMathEcECPoint_AbstractF2m *p = (OrgSpongycastleMathEcECPoint_AbstractF2m *) cast_chk(point, [OrgSpongycastleMathEcECPoint_AbstractF2m class]);
  OrgSpongycastleMathEcECCurve_AbstractF2m *curve = (OrgSpongycastleMathEcECCurve_AbstractF2m *) cast_chk([((OrgSpongycastleMathEcECPoint_AbstractF2m *) nil_chk(p)) getCurve], [OrgSpongycastleMathEcECCurve_AbstractF2m class]);
  jint m = [((OrgSpongycastleMathEcECCurve_AbstractF2m *) nil_chk(curve)) getFieldSize];
  jbyte a = [((JavaMathBigInteger *) nil_chk([((OrgSpongycastleMathEcECFieldElement *) nil_chk([curve getA])) toBigInteger])) charValue];
  jbyte mu = OrgSpongycastleMathEcTnaf_getMuWithInt_(a);
  IOSObjectArray *s = [curve getSi];
  
#line 37
  OrgSpongycastleMathEcZTauElement *rho = OrgSpongycastleMathEcTnaf_partModReductionWithJavaMathBigInteger_withInt_withByte_withJavaMathBigIntegerArray_withByte_withByte_(k, m, a, s, mu, (jbyte) 10);
  
#line 39
  return OrgSpongycastleMathEcWTauNafMultiplier_multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withOrgSpongycastleMathEcZTauElement_withOrgSpongycastleMathEcPreCompInfo_withByte_withByte_(self, p, rho, [curve getPreCompInfoWithOrgSpongycastleMathEcECPoint:p withNSString:OrgSpongycastleMathEcWTauNafMultiplier_PRECOMP_NAME], a, mu);
}


#line 52
- (OrgSpongycastleMathEcECPoint_AbstractF2m *)multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m:(OrgSpongycastleMathEcECPoint_AbstractF2m *)p
                                                                   withOrgSpongycastleMathEcZTauElement:(OrgSpongycastleMathEcZTauElement *)lambda
                                                                   withOrgSpongycastleMathEcPreCompInfo:(id<OrgSpongycastleMathEcPreCompInfo>)preCompInfo
                                                                                               withByte:(jbyte)a
                                                                                               withByte:(jbyte)mu {
  return OrgSpongycastleMathEcWTauNafMultiplier_multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withOrgSpongycastleMathEcZTauElement_withOrgSpongycastleMathEcPreCompInfo_withByte_withByte_(self, p, lambda, preCompInfo, a, mu);
}


#line 74
+ (OrgSpongycastleMathEcECPoint_AbstractF2m *)multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m:(OrgSpongycastleMathEcECPoint_AbstractF2m *)p
                                                                                              withByteArray:(IOSByteArray *)u
                                                                       withOrgSpongycastleMathEcPreCompInfo:(id<OrgSpongycastleMathEcPreCompInfo>)preCompInfo {
  return OrgSpongycastleMathEcWTauNafMultiplier_multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withByteArray_withOrgSpongycastleMathEcPreCompInfo_(p, u, preCompInfo);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcECPoint;", 0x4, 0, 1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcECPoint_AbstractF2m;", 0x2, 2, 3, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcECPoint_AbstractF2m;", 0xa, 4, 5, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(multiplyPositiveWithOrgSpongycastleMathEcECPoint:withJavaMathBigInteger:);
  methods[2].selector = @selector(multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m:withOrgSpongycastleMathEcZTauElement:withOrgSpongycastleMathEcPreCompInfo:withByte:withByte:);
  methods[3].selector = @selector(multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m:withByteArray:withOrgSpongycastleMathEcPreCompInfo:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "PRECOMP_NAME", "LNSString;", .constantValue.asLong = 0, 0x18, -1, 6, -1, -1 },
  };
  static const void *ptrTable[] = { "multiplyPositive", "LOrgSpongycastleMathEcECPoint;LJavaMathBigInteger;", "multiplyWTnaf", "LOrgSpongycastleMathEcECPoint_AbstractF2m;LOrgSpongycastleMathEcZTauElement;LOrgSpongycastleMathEcPreCompInfo;BB", "multiplyFromWTnaf", "LOrgSpongycastleMathEcECPoint_AbstractF2m;[BLOrgSpongycastleMathEcPreCompInfo;", &OrgSpongycastleMathEcWTauNafMultiplier_PRECOMP_NAME };
  static const J2ObjcClassInfo _OrgSpongycastleMathEcWTauNafMultiplier = { "WTauNafMultiplier", "org.spongycastle.math.ec", ptrTable, methods, fields, 7, 0x1, 4, 1, -1, -1, -1, -1, -1 };
  return &_OrgSpongycastleMathEcWTauNafMultiplier;
}

@end


#line 9
void OrgSpongycastleMathEcWTauNafMultiplier_init(OrgSpongycastleMathEcWTauNafMultiplier *self) {
  OrgSpongycastleMathEcAbstractECMultiplier_init(self);
}


#line 9
OrgSpongycastleMathEcWTauNafMultiplier *new_OrgSpongycastleMathEcWTauNafMultiplier_init() {
  J2OBJC_NEW_IMPL(OrgSpongycastleMathEcWTauNafMultiplier, init)
}


#line 9
OrgSpongycastleMathEcWTauNafMultiplier *create_OrgSpongycastleMathEcWTauNafMultiplier_init() {
  J2OBJC_CREATE_IMPL(OrgSpongycastleMathEcWTauNafMultiplier, init)
}


#line 52
OrgSpongycastleMathEcECPoint_AbstractF2m *OrgSpongycastleMathEcWTauNafMultiplier_multiplyWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withOrgSpongycastleMathEcZTauElement_withOrgSpongycastleMathEcPreCompInfo_withByte_withByte_(OrgSpongycastleMathEcWTauNafMultiplier *self, OrgSpongycastleMathEcECPoint_AbstractF2m *p, OrgSpongycastleMathEcZTauElement *lambda, id<OrgSpongycastleMathEcPreCompInfo> preCompInfo, jbyte a, jbyte mu) {
  
#line 55
  IOSObjectArray *alpha = (a == 0) ? JreLoadStatic(OrgSpongycastleMathEcTnaf, alpha0) : JreLoadStatic(OrgSpongycastleMathEcTnaf, alpha1);
  
#line 57
  JavaMathBigInteger *tw = OrgSpongycastleMathEcTnaf_getTwWithByte_withInt_(mu, OrgSpongycastleMathEcTnaf_WIDTH);
  
#line 59
  IOSByteArray *u = OrgSpongycastleMathEcTnaf_tauAdicWNafWithByte_withOrgSpongycastleMathEcZTauElement_withByte_withJavaMathBigInteger_withJavaMathBigInteger_withOrgSpongycastleMathEcZTauElementArray_(mu, lambda, OrgSpongycastleMathEcTnaf_WIDTH, JavaMathBigInteger_valueOfWithLong_(
#line 60
  OrgSpongycastleMathEcTnaf_POW_2_WIDTH), tw, alpha);
  
#line 62
  return OrgSpongycastleMathEcWTauNafMultiplier_multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withByteArray_withOrgSpongycastleMathEcPreCompInfo_(p, u, preCompInfo);
}


#line 74
OrgSpongycastleMathEcECPoint_AbstractF2m *OrgSpongycastleMathEcWTauNafMultiplier_multiplyFromWTnafWithOrgSpongycastleMathEcECPoint_AbstractF2m_withByteArray_withOrgSpongycastleMathEcPreCompInfo_(OrgSpongycastleMathEcECPoint_AbstractF2m *p, IOSByteArray *u, id<OrgSpongycastleMathEcPreCompInfo> preCompInfo) {
  OrgSpongycastleMathEcWTauNafMultiplier_initialize();
  OrgSpongycastleMathEcECCurve_AbstractF2m *curve = (OrgSpongycastleMathEcECCurve_AbstractF2m *) cast_chk([((OrgSpongycastleMathEcECPoint_AbstractF2m *) nil_chk(p)) getCurve], [OrgSpongycastleMathEcECCurve_AbstractF2m class]);
  jbyte a = [((JavaMathBigInteger *) nil_chk([((OrgSpongycastleMathEcECFieldElement *) nil_chk([((OrgSpongycastleMathEcECCurve_AbstractF2m *) nil_chk(curve)) getA])) toBigInteger])) charValue];
  
#line 79
  IOSObjectArray *pu;
  if ((preCompInfo == nil) || !([preCompInfo isKindOfClass:[OrgSpongycastleMathEcWTauNafPreCompInfo class]])) {
    
#line 82
    pu = OrgSpongycastleMathEcTnaf_getPreCompWithOrgSpongycastleMathEcECPoint_AbstractF2m_withByte_(p, a);
    
#line 84
    OrgSpongycastleMathEcWTauNafPreCompInfo *pre = new_OrgSpongycastleMathEcWTauNafPreCompInfo_init();
    [pre setPreCompWithOrgSpongycastleMathEcECPoint_AbstractF2mArray:pu];
    [curve setPreCompInfoWithOrgSpongycastleMathEcECPoint:p withNSString:OrgSpongycastleMathEcWTauNafMultiplier_PRECOMP_NAME withOrgSpongycastleMathEcPreCompInfo:pre];
  }
  else {
    
#line 90
    pu = [((OrgSpongycastleMathEcWTauNafPreCompInfo *) nil_chk(((OrgSpongycastleMathEcWTauNafPreCompInfo *) cast_chk(preCompInfo, [OrgSpongycastleMathEcWTauNafPreCompInfo class])))) getPreComp];
  }
  
#line 94
  IOSObjectArray *puNeg = [IOSObjectArray newArrayWithLength:((IOSObjectArray *) nil_chk(pu))->size_ type:OrgSpongycastleMathEcECPoint_AbstractF2m_class_()];
  for (jint i = 0; i < pu->size_; ++i) {
    
#line 97
    (void) IOSObjectArray_Set(puNeg, i, (OrgSpongycastleMathEcECPoint_AbstractF2m *) cast_chk([((OrgSpongycastleMathEcECPoint_AbstractF2m *) nil_chk(IOSObjectArray_Get(pu, i))) negate], [OrgSpongycastleMathEcECPoint_AbstractF2m class]));
  }
  
#line 102
  OrgSpongycastleMathEcECPoint_AbstractF2m *q = (OrgSpongycastleMathEcECPoint_AbstractF2m *) cast_chk([((OrgSpongycastleMathEcECCurve *) nil_chk([p getCurve])) getInfinity], [OrgSpongycastleMathEcECPoint_AbstractF2m class]);
  
#line 104
  jint tauCount = 0;
  for (jint i = ((IOSByteArray *) nil_chk(u))->size_ - 1; i >= 0; i--) {
    
#line 107
    ++tauCount;
    jint ui = IOSByteArray_Get(u, i);
    if (ui != 0) {
      
#line 111
      q = [((OrgSpongycastleMathEcECPoint_AbstractF2m *) nil_chk(q)) tauPowWithInt:tauCount];
      tauCount = 0;
      
#line 114
      OrgSpongycastleMathEcECPoint *x = ui > 0 ? IOSObjectArray_Get(pu, JreURShift32(ui, 1)) : IOSObjectArray_Get(puNeg, JreURShift32((-ui), 1));
      q = (OrgSpongycastleMathEcECPoint_AbstractF2m *) cast_chk([((OrgSpongycastleMathEcECPoint_AbstractF2m *) nil_chk(q)) addWithOrgSpongycastleMathEcECPoint:x], [OrgSpongycastleMathEcECPoint_AbstractF2m class]);
    }
  }
  if (tauCount > 0) {
    
#line 120
    q = [((OrgSpongycastleMathEcECPoint_AbstractF2m *) nil_chk(q)) tauPowWithInt:tauCount];
  }
  return q;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastleMathEcWTauNafMultiplier)
