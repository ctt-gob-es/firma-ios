//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/desarrolloabamobile/Downloads/pades-ios-mini/src/main/java/com/aowagie/text/xml/xmp/XmpReader.java
//

#include "ExceptionConverter.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "XMLConstants.h"
#include "XmlDomWriter.h"
#include "XmpReader.h"
#include "XmpWriter.h"
#include "java/io/ByteArrayInputStream.h"
#include "java/io/ByteArrayOutputStream.h"
#include "java/io/StringReader.h"
#include "java/lang/Boolean.h"
#include "java/lang/Exception.h"
#include "java/util/logging/Level.h"
#include "java/util/logging/Logger.h"
#include "javax/xml/parsers/DocumentBuilder.h"
#include "javax/xml/parsers/DocumentBuilderFactory.h"
#include "javax/xml/parsers/ParserConfigurationException.h"
#include "org/w3c/dom/Document.h"
#include "org/w3c/dom/Element.h"
#include "org/w3c/dom/NamedNodeMap.h"
#include "org/w3c/dom/Node.h"
#include "org/w3c/dom/NodeList.h"
#include "org/w3c/dom/Text.h"
#include "org/xml/sax/EntityResolver.h"
#include "org/xml/sax/InputSource.h"

#if !__has_feature(objc_arc)
#error "XmpReader must be compiled with ARC (-fobjc-arc)"
#endif

@interface ComAowagieTextXmlXmpXmpReader () {
 @public
  id<OrgW3cDomDocument> domDocument_;
}

+ (JavaxXmlParsersDocumentBuilderFactory *)getSecureDocumentFactory;

/*!
 @brief Sets the text of this node.All the child's node are deleted and a new
  child text node is created.
 @param domDocument the  <CODE> Document </CODE>  that contains the node
 @param n the  <CODE> Node </CODE>  to add the text to
 @param value the text to add
 */
- (jboolean)setNodeTextWithOrgW3cDomDocument:(id<OrgW3cDomDocument>)domDocument
                           withOrgW3cDomNode:(id<OrgW3cDomNode>)n
                                withNSString:(NSString *)value;

@end

J2OBJC_FIELD_SETTER(ComAowagieTextXmlXmpXmpReader, domDocument_, id<OrgW3cDomDocument>)

inline JavaxXmlParsersDocumentBuilderFactory *ComAowagieTextXmlXmpXmpReader_get_SECURE_FACTORY(void);
inline JavaxXmlParsersDocumentBuilderFactory *ComAowagieTextXmlXmpXmpReader_set_SECURE_FACTORY(JavaxXmlParsersDocumentBuilderFactory *value);
static JavaxXmlParsersDocumentBuilderFactory *ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY;
J2OBJC_STATIC_FIELD_OBJ(ComAowagieTextXmlXmpXmpReader, SECURE_FACTORY, JavaxXmlParsersDocumentBuilderFactory *)

inline JavaUtilLoggingLogger *ComAowagieTextXmlXmpXmpReader_get_LOGGER(void);
static JavaUtilLoggingLogger *ComAowagieTextXmlXmpXmpReader_LOGGER;
J2OBJC_STATIC_FIELD_OBJ_FINAL(ComAowagieTextXmlXmpXmpReader, LOGGER, JavaUtilLoggingLogger *)

__attribute__((unused)) static JavaxXmlParsersDocumentBuilderFactory *ComAowagieTextXmlXmpXmpReader_getSecureDocumentFactory(void);

__attribute__((unused)) static jboolean ComAowagieTextXmlXmpXmpReader_setNodeTextWithOrgW3cDomDocument_withOrgW3cDomNode_withNSString_(ComAowagieTextXmlXmpXmpReader *self, id<OrgW3cDomDocument> domDocument, id<OrgW3cDomNode> n, NSString *value);

@interface ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver : NSObject < OrgXmlSaxEntityResolver >

- (instancetype)init;

- (OrgXmlSaxInputSource *)resolveEntityWithNSString:(NSString *)publicId
                                       withNSString:(NSString *)systemId;

@end

J2OBJC_EMPTY_STATIC_INIT(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver)

__attribute__((unused)) static void ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver *self);

__attribute__((unused)) static ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver *new_ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init(void) NS_RETURNS_RETAINED;

__attribute__((unused)) static ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver *create_ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init(void);

J2OBJC_TYPE_LITERAL_HEADER(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver)

#line 1 "/Users/desarrolloabamobile/Downloads/pades-ios-mini/src/main/java/com/aowagie/text/xml/xmp/XmpReader.java"

J2OBJC_INITIALIZED_DEFN(ComAowagieTextXmlXmpXmpReader)


#line 78
@implementation ComAowagieTextXmlXmpXmpReader


#line 92
- (instancetype)initWithByteArray:(IOSByteArray *)bytes {
  ComAowagieTextXmlXmpXmpReader_initWithByteArray_(self, bytes);
  return self;
}


#line 105
+ (JavaxXmlParsersDocumentBuilderFactory *)getSecureDocumentFactory {
  return ComAowagieTextXmlXmpXmpReader_getSecureDocumentFactory();
}


#line 156
- (jboolean)replaceWithNSString:(NSString *)parent
                   withNSString:(NSString *)namespaceURI
                   withNSString:(NSString *)localName
                   withNSString:(NSString *)value {
  id<OrgW3cDomNodeList> nodes = [((id<OrgW3cDomDocument>) nil_chk(self->domDocument_)) getElementsByTagNameNSWithNSString:namespaceURI withNSString:localName];
  if ([((id<OrgW3cDomNodeList>) nil_chk(nodes)) getLength] > 0) {
    id<OrgW3cDomNode> node;
    for (jint i = 0; i < [nodes getLength]; i++) {
      node = [nodes itemWithInt:i];
      ComAowagieTextXmlXmpXmpReader_setNodeTextWithOrgW3cDomDocument_withOrgW3cDomNode_withNSString_(self, self->domDocument_, node, value);
    }
    return true;
  }
  
#line 172
  id<OrgW3cDomNodeList> parentNodes = parent == nil ?
#line 173
  nil :
#line 174
  [((id<OrgW3cDomDocument>) nil_chk(self->domDocument_)) getElementsByTagNameWithNSString:parent];
  if (parentNodes == nil || [parentNodes getLength] == 0) {
    return false;
  }
  
#line 181
  id<OrgW3cDomNode> node;
  id<OrgW3cDomNamedNodeMap> attrMap;
  jboolean replaced = false;
  for (jint i = 0; i < [parentNodes getLength]; i++) {
    node = [parentNodes itemWithInt:i];
    attrMap = [((id<OrgW3cDomNode>) nil_chk(node)) getAttributes];
    if (attrMap != nil) {
      id<OrgW3cDomNode> targetAttr = [attrMap getNamedItemNSWithNSString:namespaceURI withNSString:localName];
      if (targetAttr != nil) {
        [targetAttr setNodeValueWithNSString:value];
        replaced = true;
      }
    }
  }
  return replaced;
}


#line 207
- (jboolean)addWithNSString:(NSString *)parent
               withNSString:(NSString *)namespaceURI
               withNSString:(NSString *)localName
               withNSString:(NSString *)value {
  
#line 208
  id<OrgW3cDomNodeList> nodes = [((id<OrgW3cDomDocument>) nil_chk(self->domDocument_)) getElementsByTagNameWithNSString:parent];
  if ([((id<OrgW3cDomNodeList>) nil_chk(nodes)) getLength] == 0) {
    return false;
  }
  id<OrgW3cDomNode> pNode;
  id<OrgW3cDomNode> node;
  for (jint i = 0; i < [nodes getLength]; i++) {
    pNode = [nodes itemWithInt:i];
    id<OrgW3cDomNamedNodeMap> attrs = [((id<OrgW3cDomNode>) nil_chk(pNode)) getAttributes];
    for (jint j = 0; j < [((id<OrgW3cDomNamedNodeMap>) nil_chk(attrs)) getLength]; j++) {
      node = [attrs itemWithInt:j];
      if ([((NSString *) nil_chk(namespaceURI)) isEqual:[((id<OrgW3cDomNode>) nil_chk(node)) getNodeValue]]) {
        node = [((id<OrgW3cDomDocument>) nil_chk(self->domDocument_)) createElementWithNSString:localName];
        (void) [((id<OrgW3cDomNode>) nil_chk(node)) appendChildWithOrgW3cDomNode:[((id<OrgW3cDomDocument>) nil_chk(self->domDocument_)) createTextNodeWithNSString:value]];
        (void) [pNode appendChildWithOrgW3cDomNode:node];
        return true;
      }
    }
  }
  return false;
}


#line 237
- (jboolean)setNodeTextWithOrgW3cDomDocument:(id<OrgW3cDomDocument>)domDocument
                           withOrgW3cDomNode:(id<OrgW3cDomNode>)n
                                withNSString:(NSString *)value {
  return ComAowagieTextXmlXmpXmpReader_setNodeTextWithOrgW3cDomDocument_withOrgW3cDomNode_withNSString_(self, domDocument, n, value);
}


#line 254
- (IOSByteArray *)serializeDoc {
  ComAowagieTextXmlXmlDomWriter *xw = new_ComAowagieTextXmlXmlDomWriter_init();
  JavaIoByteArrayOutputStream *fout = new_JavaIoByteArrayOutputStream_init();
  [xw setOutputWithJavaIoOutputStream:fout withNSString:nil];
  [fout writeWithByteArray:[((NSString *) nil_chk(ComAowagieTextXmlXmpXmpWriter_XPACKET_PI_BEGIN)) java_getBytesWithCharsetName:@"UTF-8"]];
  [fout flush];
  id<OrgW3cDomNodeList> xmpmeta = [((id<OrgW3cDomDocument>) nil_chk(self->domDocument_)) getElementsByTagNameWithNSString:@"x:xmpmeta"];
  [xw writeWithOrgW3cDomNode:[((id<OrgW3cDomNodeList>) nil_chk(xmpmeta)) itemWithInt:0]];
  [fout flush];
  for (jint i = 0; i < 20; i++) {
    [fout writeWithByteArray:[((NSString *) nil_chk(ComAowagieTextXmlXmpXmpWriter_EXTRASPACE)) java_getBytes]];
  }
  [fout writeWithByteArray:[((NSString *) nil_chk(ComAowagieTextXmlXmpXmpWriter_XPACKET_PI_END_W)) java_getBytes]];
  [fout close];
  return [fout toByteArray];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, 1, -1, -1, -1 },
    { NULL, "LJavaxXmlParsersDocumentBuilderFactory;", 0x2a, -1, -1, -1, -1, -1, -1 },
    { NULL, "Z", 0x1, 2, 3, -1, -1, -1, -1 },
    { NULL, "Z", 0x1, 4, 3, -1, -1, -1, -1 },
    { NULL, "Z", 0x2, 5, 6, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, -1, -1, 7, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithByteArray:);
  methods[1].selector = @selector(getSecureDocumentFactory);
  methods[2].selector = @selector(replaceWithNSString:withNSString:withNSString:withNSString:);
  methods[3].selector = @selector(addWithNSString:withNSString:withNSString:withNSString:);
  methods[4].selector = @selector(setNodeTextWithOrgW3cDomDocument:withOrgW3cDomNode:withNSString:);
  methods[5].selector = @selector(serializeDoc);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "domDocument_", "LOrgW3cDomDocument;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "SECURE_FACTORY", "LJavaxXmlParsersDocumentBuilderFactory;", .constantValue.asLong = 0, 0xa, -1, 8, -1, -1 },
    { "LOGGER", "LJavaUtilLoggingLogger;", .constantValue.asLong = 0, 0x1a, -1, 9, -1, -1 },
  };
  static const void *ptrTable[] = { "[B", "LOrgXmlSaxSAXException;LJavaIoIOException;", "replace", "LNSString;LNSString;LNSString;LNSString;", "add", "setNodeText", "LOrgW3cDomDocument;LOrgW3cDomNode;LNSString;", "LJavaIoIOException;", &ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY, &ComAowagieTextXmlXmpXmpReader_LOGGER, "LComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver;" };
  static const J2ObjcClassInfo _ComAowagieTextXmlXmpXmpReader = { "XmpReader", "com.aowagie.text.xml.xmp", ptrTable, methods, fields, 7, 0x1, 6, 3, -1, 10, -1, -1, -1 };
  return &_ComAowagieTextXmlXmpXmpReader;
}

+ (void)initialize {
  if (self == [ComAowagieTextXmlXmpXmpReader class]) {
    ComAowagieTextXmlXmpXmpReader_LOGGER = JavaUtilLoggingLogger_getLoggerWithNSString_(
#line 84
    [ComAowagieTextXmlXmpXmpReader_class_() getName]);
    J2OBJC_SET_INITIALIZED(ComAowagieTextXmlXmpXmpReader)
  }
}

@end


#line 92
void ComAowagieTextXmlXmpXmpReader_initWithByteArray_(ComAowagieTextXmlXmpXmpReader *self, IOSByteArray *bytes) {
  NSObject_init(self);
  
#line 93
  @try {
    JavaxXmlParsersDocumentBuilderFactory *fact = ComAowagieTextXmlXmpXmpReader_getSecureDocumentFactory();
    [((JavaxXmlParsersDocumentBuilderFactory *) nil_chk(fact)) setNamespaceAwareWithBoolean:true];
    JavaxXmlParsersDocumentBuilder *db = [fact newDocumentBuilder];
    [((JavaxXmlParsersDocumentBuilder *) nil_chk(db)) setEntityResolverWithOrgXmlSaxEntityResolver:new_ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init()];
    JavaIoByteArrayInputStream *bais = new_JavaIoByteArrayInputStream_initWithByteArray_(bytes);
    self->domDocument_ = [db parseWithJavaIoInputStream:bais];
  }
  @catch (
#line 100
  JavaxXmlParsersParserConfigurationException *e) {
    @throw new_ComAowagieTextExceptionConverter_initWithJavaLangException_(e);
  }
}


#line 92
ComAowagieTextXmlXmpXmpReader *new_ComAowagieTextXmlXmpXmpReader_initWithByteArray_(IOSByteArray *bytes) {
  J2OBJC_NEW_IMPL(ComAowagieTextXmlXmpXmpReader, initWithByteArray_, bytes)
}


#line 92
ComAowagieTextXmlXmpXmpReader *create_ComAowagieTextXmlXmpXmpReader_initWithByteArray_(IOSByteArray *bytes) {
  J2OBJC_CREATE_IMPL(ComAowagieTextXmlXmpXmpReader, initWithByteArray_, bytes)
}


#line 105
JavaxXmlParsersDocumentBuilderFactory *ComAowagieTextXmlXmpXmpReader_getSecureDocumentFactory() {
  ComAowagieTextXmlXmpXmpReader_initialize();
  @synchronized(ComAowagieTextXmlXmpXmpReader_class_()) {
    
#line 107
    if (ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY != nil) {
      return JreRetainedLocalValue(ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY);
    }
    
#line 111
    ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY = JavaxXmlParsersDocumentBuilderFactory_newInstance();
    
#line 114
    @try {
      [((JavaxXmlParsersDocumentBuilderFactory *) nil_chk(ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY)) setFeatureWithNSString:ComAowagieTextXmlXMLConstants_FEATURE_SECURE_PROCESSING withBoolean:[((JavaLangBoolean *) nil_chk(JreLoadStatic(JavaLangBoolean, TRUE))) booleanValue]];
    }
    @catch (JavaLangException *e) {
      [((JavaUtilLoggingLogger *) nil_chk(ComAowagieTextXmlXmpXmpReader_LOGGER)) logWithJavaUtilLoggingLevel:JreLoadStatic(JavaUtilLoggingLevel, WARNING) withNSString:JreStrcat("$@", @"No se pudo configurar el procesador seguro: ", e)];
    }
    
#line 124
    IOSObjectArray *securityProperties = [IOSObjectArray newArrayWithObjects:(id[]){
#line 125
      ComAowagieTextXmlXMLConstants_ACCESS_EXTERNAL_DTD,
#line 126
      ComAowagieTextXmlXMLConstants_ACCESS_EXTERNAL_SCHEMA,
#line 127
      ComAowagieTextXmlXMLConstants_ACCESS_EXTERNAL_STYLESHEET } count:3 type:NSString_class_()];
      {
        IOSObjectArray *a__ = securityProperties;
        NSString * const *b__ = a__->buffer_;
        NSString * const *e__ = b__ + a__->size_;
        while (b__ < e__) {
          NSString *securityProperty = *b__++;
          
#line 130
          @try {
            [((JavaxXmlParsersDocumentBuilderFactory *) nil_chk(ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY)) setAttributeWithNSString:securityProperty withId:@""];
          }
          @catch (JavaLangException *e) {
            
#line 136
            if ([((JavaUtilLoggingLogger *) nil_chk(ComAowagieTextXmlXmpXmpReader_LOGGER)) isLoggableWithJavaUtilLoggingLevel:JreLoadStatic(JavaUtilLoggingLevel, FINE)]) {
              [ComAowagieTextXmlXmpXmpReader_LOGGER logWithJavaUtilLoggingLevel:JreLoadStatic(JavaUtilLoggingLevel, FINE) withNSString:JreStrcat("$$$@", @"No se ha podido establecer una propiedad de seguridad '", securityProperty, @"' en la factoria XML: ", e)];
            }
          }
        }
      }
      [((JavaxXmlParsersDocumentBuilderFactory *) nil_chk(ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY)) setValidatingWithBoolean:false];
      
#line 144
      return JreRetainedLocalValue(ComAowagieTextXmlXmpXmpReader_SECURE_FACTORY);
    }
  }


#line 237
jboolean ComAowagieTextXmlXmpXmpReader_setNodeTextWithOrgW3cDomDocument_withOrgW3cDomNode_withNSString_(ComAowagieTextXmlXmpXmpReader *self, id<OrgW3cDomDocument> domDocument, id<OrgW3cDomNode> n, NSString *value) {
  if (n == nil) {
    return false;
  }
  id<OrgW3cDomNode> nc = nil;
  while ((nc = [n getFirstChild]) != nil) {
    (void) [n removeChildWithOrgW3cDomNode:nc];
  }
  (void) [n appendChildWithOrgW3cDomNode:[((id<OrgW3cDomDocument>) nil_chk(domDocument)) createTextNodeWithNSString:value]];
  return true;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComAowagieTextXmlXmpXmpReader)

#line 1 "/Users/desarrolloabamobile/Downloads/pades-ios-mini/src/main/java/com/aowagie/text/xml/xmp/XmpReader.java"


#line 271
@implementation ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver

J2OBJC_IGNORE_DESIGNATED_BEGIN

#line 271
- (instancetype)init {
  ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END


#line 272
- (OrgXmlSaxInputSource *)resolveEntityWithNSString:(NSString *)publicId
                                       withNSString:(NSString *)systemId {
  return new_OrgXmlSaxInputSource_initWithJavaIoReader_(new_JavaIoStringReader_initWithNSString_(@""));
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgXmlSaxInputSource;", 0x1, 0, 1, 2, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(resolveEntityWithNSString:withNSString:);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "resolveEntity", "LNSString;LNSString;", "LOrgXmlSaxSAXException;LJavaIoIOException;", "LComAowagieTextXmlXmpXmpReader;" };
  static const J2ObjcClassInfo _ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver = { "SafeEmptyEntityResolver", "com.aowagie.text.xml.xmp", ptrTable, methods, NULL, 7, 0xa, 2, 0, 3, -1, -1, -1, -1 };
  return &_ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver;
}

@end


#line 271
void ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver *self) {
  NSObject_init(self);
}


#line 271
ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver *new_ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init() {
  J2OBJC_NEW_IMPL(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver, init)
}


#line 271
ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver *create_ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver_init() {
  J2OBJC_CREATE_IMPL(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComAowagieTextXmlXmpXmpReader_SafeEmptyEntityResolver)
