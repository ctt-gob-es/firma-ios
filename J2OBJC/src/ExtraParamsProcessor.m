//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/desarrolloabamobile/Downloads/pades-ios-mini/src/main/java/es/gob/afirma/core/signers/ExtraParamsProcessor.java
//

#include "AOSignConstants.h"
#include "AOSigner.h"
#include "AOUtil.h"
#include "AdESPolicyPropertiesManager.h"
#include "Base64.h"
#include "ExtraParamsProcessor.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/ByteArrayInputStream.h"
#include "java/io/IOException.h"
#include "java/io/InputStream.h"
#include "java/lang/Exception.h"
#include "java/lang/Throwable.h"
#include "java/lang/reflect/Method.h"
#include "java/net/URI.h"
#include "java/util/Locale.h"
#include "java/util/Properties.h"
#include "java/util/Set.h"
#include "java/util/logging/Logger.h"

#if !__has_feature(objc_arc)
#error "ExtraParamsProcessor must be compiled with ARC (-fobjc-arc)"
#endif

@interface EsGobAfirmaCoreSignersExtraParamsProcessor ()

- (instancetype)init;

/*!
 @brief Expande las propiedades de pol&iacute;tica de firma modificando el conjunto de propiedades.
 @param p Propiedades configuradas.
 @param signedData Datos firmados.
 @param format Formato de firma.
 @throw IncompatiblePolicyExceptionSi el formato de firma es incompatible con la pol&iacute;tica indicada.
 */
+ (void)expandPolicyKeysWithJavaUtilProperties:(JavaUtilProperties *)p
                                 withByteArray:(IOSByteArray *)signedData
                                  withNSString:(NSString *)format;

/*!
 @brief Normaliza el nombre de formato de firma para simplificar comprobaciones posteriores.
 @param format Nombre del formato de firma.
 @return Nombre homogenizado del formato de firma o la misma cadena de entrada si no es
  uno de los nombres de formato soportados.
 */
+ (NSString *)normalizeFormatWithNSString:(NSString *)format;

/*!
 @brief Indica si la expansi&oacute;n de propiedades est&aacute; habilitada para una
  pol&iacute;tica de firma concreta.
 @param policyName Nombre de la pol &iacute; tica de firma.
 @return <code>true</code> si la pol&iacute;tica esta soportada, <code>false</code> en
  caso contrario.
 */
+ (jboolean)isSupportedPolicyWithNSString:(NSString *)policyName;

/*!
 @brief Establece los atributos correspondientes a las firmas CAdES para la policita de
  firma de la AGE.
 @param policyName Nombre de la pol &iacute; tica de firma.
 @param params Conjunto de propiedades en donde hay que establecer los atributos  de la pol
  &iacute; tica de firma.
 @param signedData Datos firmados.
 */
+ (void)setCAdESPolicyAGEAttributesWithNSString:(NSString *)policyName
                         withJavaUtilProperties:(JavaUtilProperties *)params
                                  withByteArray:(IOSByteArray *)signedData;

/*!
 @brief Establece los atributos correspondientes a las firmas XAdES para la policita de
  firma de la AGE.
 @param policyName Nombre de la pol &iacute; tica de firma.
 @param params Conjunto de propiedades en donde hay que establecer los atributos  de la pol
  &iacute; tica de firma.
 */
+ (void)setXAdESPolicyAGEAttributesWithNSString:(NSString *)policyName
                         withJavaUtilProperties:(JavaUtilProperties *)params;

/*!
 @brief Establece los atributos correspondientes a las firmas PAdES para la policita de
  firma de la AGE.
 @param policyName Nombre de la pol &iacute; tica de firma.
 @param params Conjunto de propiedades en donde hay que establecer los atributos  de la pol
  &iacute; tica de firma.
 @throw IncompatiblePolicyExceptionCuando se ha declarado utilizar un subfiltro
  no permitido por la pol&iacute;tica de firma de la AGE.
 */
+ (void)setPAdESPolicyAGEAttributesWithNSString:(NSString *)policyName
                         withJavaUtilProperties:(JavaUtilProperties *)params;

@end

/*!
 @brief Tama&ntilde;o equivalente a 1 MegaBytes en bytes.
 */
inline jint EsGobAfirmaCoreSignersExtraParamsProcessor_get_SIZE_1MB(void);
#define EsGobAfirmaCoreSignersExtraParamsProcessor_SIZE_1MB 1048576
J2OBJC_STATIC_FIELD_CONSTANT(EsGobAfirmaCoreSignersExtraParamsProcessor, SIZE_1MB, jint)

inline NSString *EsGobAfirmaCoreSignersExtraParamsProcessor_get_ETSI_CADES_DETACHED(void);
static NSString *EsGobAfirmaCoreSignersExtraParamsProcessor_ETSI_CADES_DETACHED = @"ETSI.CAdES.detached";
J2OBJC_STATIC_FIELD_OBJ_FINAL(EsGobAfirmaCoreSignersExtraParamsProcessor, ETSI_CADES_DETACHED, NSString *)

/*!
 @brief Clave expansible para pol&iacute;ticas de firma.
 */
inline NSString *EsGobAfirmaCoreSignersExtraParamsProcessor_get_EXPANDIBLE_POLICY_KEY(void);
static NSString *EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY = @"expPolicy";
J2OBJC_STATIC_FIELD_OBJ_FINAL(EsGobAfirmaCoreSignersExtraParamsProcessor, EXPANDIBLE_POLICY_KEY, NSString *)

/*!
 @brief Taman&ntilde;o m&aacute;ximo de ruta permitido para cargar un documento local
  cuando se deshabilita el modo seguro.
 */
inline jint EsGobAfirmaCoreSignersExtraParamsProcessor_get_MAX_PATH_SIZE(void);
#define EsGobAfirmaCoreSignersExtraParamsProcessor_MAX_PATH_SIZE 255
J2OBJC_STATIC_FIELD_CONSTANT(EsGobAfirmaCoreSignersExtraParamsProcessor, MAX_PATH_SIZE, jint)

/*!
 @brief Manejador del log.
 */
inline JavaUtilLoggingLogger *EsGobAfirmaCoreSignersExtraParamsProcessor_get_LOGGER(void);
static JavaUtilLoggingLogger *EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER;
J2OBJC_STATIC_FIELD_OBJ_FINAL(EsGobAfirmaCoreSignersExtraParamsProcessor, LOGGER, JavaUtilLoggingLogger *)

__attribute__((unused)) static void EsGobAfirmaCoreSignersExtraParamsProcessor_init(EsGobAfirmaCoreSignersExtraParamsProcessor *self);

__attribute__((unused)) static EsGobAfirmaCoreSignersExtraParamsProcessor *new_EsGobAfirmaCoreSignersExtraParamsProcessor_init(void) NS_RETURNS_RETAINED;

__attribute__((unused)) static EsGobAfirmaCoreSignersExtraParamsProcessor *create_EsGobAfirmaCoreSignersExtraParamsProcessor_init(void);

__attribute__((unused)) static void EsGobAfirmaCoreSignersExtraParamsProcessor_expandPolicyKeysWithJavaUtilProperties_withByteArray_withNSString_(JavaUtilProperties *p, IOSByteArray *signedData, NSString *format);

__attribute__((unused)) static NSString *EsGobAfirmaCoreSignersExtraParamsProcessor_normalizeFormatWithNSString_(NSString *format);

__attribute__((unused)) static jboolean EsGobAfirmaCoreSignersExtraParamsProcessor_isSupportedPolicyWithNSString_(NSString *policyName);

__attribute__((unused)) static void EsGobAfirmaCoreSignersExtraParamsProcessor_setCAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_withByteArray_(NSString *policyName, JavaUtilProperties *params, IOSByteArray *signedData);

__attribute__((unused)) static void EsGobAfirmaCoreSignersExtraParamsProcessor_setXAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(NSString *policyName, JavaUtilProperties *params);

__attribute__((unused)) static void EsGobAfirmaCoreSignersExtraParamsProcessor_setPAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(NSString *policyName, JavaUtilProperties *params);

inline jlong EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_get_serialVersionUID(void);
#define EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_serialVersionUID -6420193548487585455LL
J2OBJC_STATIC_FIELD_CONSTANT(EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException, serialVersionUID, jlong)

#line 1 "/Users/desarrolloabamobile/Downloads/pades-ios-mini/src/main/java/es/gob/afirma/core/signers/ExtraParamsProcessor.java"

J2OBJC_INITIALIZED_DEFN(EsGobAfirmaCoreSignersExtraParamsProcessor)


#line 26
@implementation EsGobAfirmaCoreSignersExtraParamsProcessor

J2OBJC_IGNORE_DESIGNATED_BEGIN

#line 45
- (instancetype)init {
  EsGobAfirmaCoreSignersExtraParamsProcessor_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END


#line 59
+ (JavaUtilProperties *)convertToPropertiesWithNSString:(NSString *)entries {
  return EsGobAfirmaCoreSignersExtraParamsProcessor_convertToPropertiesWithNSString_(entries);
}


#line 97
+ (JavaUtilProperties *)expandPropertiesWithJavaUtilProperties:(JavaUtilProperties *)params {
  return EsGobAfirmaCoreSignersExtraParamsProcessor_expandPropertiesWithJavaUtilProperties_(params);
}


#line 122
+ (JavaUtilProperties *)expandPropertiesWithJavaUtilProperties:(JavaUtilProperties *)params
                                                 withByteArray:(IOSByteArray *)signedData
                                                  withNSString:(NSString *)format {
  return EsGobAfirmaCoreSignersExtraParamsProcessor_expandPropertiesWithJavaUtilProperties_withByteArray_withNSString_(params, signedData, format);
}


#line 136
+ (void)expandPolicyKeysWithJavaUtilProperties:(JavaUtilProperties *)p
                                 withByteArray:(IOSByteArray *)signedData
                                  withNSString:(NSString *)format {
  EsGobAfirmaCoreSignersExtraParamsProcessor_expandPolicyKeysWithJavaUtilProperties_withByteArray_withNSString_(p, signedData, format);
}


#line 185
+ (NSString *)normalizeFormatWithNSString:(NSString *)format {
  return EsGobAfirmaCoreSignersExtraParamsProcessor_normalizeFormatWithNSString_(format);
}


#line 217
+ (jboolean)isSupportedPolicyWithNSString:(NSString *)policyName {
  return EsGobAfirmaCoreSignersExtraParamsProcessor_isSupportedPolicyWithNSString_(policyName);
}


#line 230
+ (void)setCAdESPolicyAGEAttributesWithNSString:(NSString *)policyName
                         withJavaUtilProperties:(JavaUtilProperties *)params
                                  withByteArray:(IOSByteArray *)signedData {
  EsGobAfirmaCoreSignersExtraParamsProcessor_setCAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_withByteArray_(policyName, params, signedData);
}


#line 261
+ (void)setXAdESPolicyAGEAttributesWithNSString:(NSString *)policyName
                         withJavaUtilProperties:(JavaUtilProperties *)params {
  EsGobAfirmaCoreSignersExtraParamsProcessor_setXAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(policyName, params);
}


#line 293
+ (void)setPAdESPolicyAGEAttributesWithNSString:(NSString *)policyName
                         withJavaUtilProperties:(JavaUtilProperties *)params {
  EsGobAfirmaCoreSignersExtraParamsProcessor_setPAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(policyName, params);
}


#line 323
+ (void)configAutoFormatWithEsGobAfirmaCoreSignersAOSigner:(id<EsGobAfirmaCoreSignersAOSigner>)signer
                                             withByteArray:(IOSByteArray *)data
                                    withJavaUtilProperties:(JavaUtilProperties *)params {
  EsGobAfirmaCoreSignersExtraParamsProcessor_configAutoFormatWithEsGobAfirmaCoreSignersAOSigner_withByteArray_withJavaUtilProperties_(signer, data, params);
}


#line 351
+ (IOSByteArray *)loadByteArrayFromExtraParamsWithJavaUtilProperties:(JavaUtilProperties *)extraParams
                                                        withNSString:(NSString *)paramName
                                                         withBoolean:(jboolean)secureMode {
  return EsGobAfirmaCoreSignersExtraParamsProcessor_loadByteArrayFromExtraParamsWithJavaUtilProperties_withNSString_withBoolean_(extraParams, paramName, secureMode);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "LJavaUtilProperties;", 0x9, 0, 1, -1, -1, -1, -1 },
    { NULL, "LJavaUtilProperties;", 0x9, 2, 3, 4, -1, -1, -1 },
    { NULL, "LJavaUtilProperties;", 0x9, 2, 5, 4, -1, -1, -1 },
    { NULL, "V", 0xa, 6, 5, 4, -1, -1, -1 },
    { NULL, "LNSString;", 0xa, 7, 1, -1, -1, -1, -1 },
    { NULL, "Z", 0xa, 8, 1, -1, -1, -1, -1 },
    { NULL, "V", 0xa, 9, 10, -1, -1, -1, -1 },
    { NULL, "V", 0xa, 11, 12, -1, -1, -1, -1 },
    { NULL, "V", 0xa, 13, 12, 4, -1, -1, -1 },
    { NULL, "V", 0x9, 14, 15, -1, -1, -1, -1 },
    { NULL, "[B", 0x9, 16, 17, 18, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(convertToPropertiesWithNSString:);
  methods[2].selector = @selector(expandPropertiesWithJavaUtilProperties:);
  methods[3].selector = @selector(expandPropertiesWithJavaUtilProperties:withByteArray:withNSString:);
  methods[4].selector = @selector(expandPolicyKeysWithJavaUtilProperties:withByteArray:withNSString:);
  methods[5].selector = @selector(normalizeFormatWithNSString:);
  methods[6].selector = @selector(isSupportedPolicyWithNSString:);
  methods[7].selector = @selector(setCAdESPolicyAGEAttributesWithNSString:withJavaUtilProperties:withByteArray:);
  methods[8].selector = @selector(setXAdESPolicyAGEAttributesWithNSString:withJavaUtilProperties:);
  methods[9].selector = @selector(setPAdESPolicyAGEAttributesWithNSString:withJavaUtilProperties:);
  methods[10].selector = @selector(configAutoFormatWithEsGobAfirmaCoreSignersAOSigner:withByteArray:withJavaUtilProperties:);
  methods[11].selector = @selector(loadByteArrayFromExtraParamsWithJavaUtilProperties:withNSString:withBoolean:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "SIZE_1MB", "I", .constantValue.asInt = EsGobAfirmaCoreSignersExtraParamsProcessor_SIZE_1MB, 0x1a, -1, -1, -1, -1 },
    { "ETSI_CADES_DETACHED", "LNSString;", .constantValue.asLong = 0, 0x1a, -1, 19, -1, -1 },
    { "EXPANDIBLE_POLICY_KEY", "LNSString;", .constantValue.asLong = 0, 0x1a, -1, 20, -1, -1 },
    { "MAX_PATH_SIZE", "I", .constantValue.asInt = EsGobAfirmaCoreSignersExtraParamsProcessor_MAX_PATH_SIZE, 0x1a, -1, -1, -1, -1 },
    { "LOGGER", "LJavaUtilLoggingLogger;", .constantValue.asLong = 0, 0x1a, -1, 21, -1, -1 },
  };
  static const void *ptrTable[] = { "convertToProperties", "LNSString;", "expandProperties", "LJavaUtilProperties;", "LEsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException;", "LJavaUtilProperties;[BLNSString;", "expandPolicyKeys", "normalizeFormat", "isSupportedPolicy", "setCAdESPolicyAGEAttributes", "LNSString;LJavaUtilProperties;[B", "setXAdESPolicyAGEAttributes", "LNSString;LJavaUtilProperties;", "setPAdESPolicyAGEAttributes", "configAutoFormat", "LEsGobAfirmaCoreSignersAOSigner;[BLJavaUtilProperties;", "loadByteArrayFromExtraParams", "LJavaUtilProperties;LNSString;Z", "LJavaIoIOException;", &EsGobAfirmaCoreSignersExtraParamsProcessor_ETSI_CADES_DETACHED, &EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY, &EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER };
  static const J2ObjcClassInfo _EsGobAfirmaCoreSignersExtraParamsProcessor = { "ExtraParamsProcessor", "es.gob.afirma.core.signers", ptrTable, methods, fields, 7, 0x11, 12, 5, -1, 4, -1, -1, -1 };
  return &_EsGobAfirmaCoreSignersExtraParamsProcessor;
}

+ (void)initialize {
  if (self == [EsGobAfirmaCoreSignersExtraParamsProcessor class]) {
    EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER = JavaUtilLoggingLogger_getLoggerWithNSString_(
#line 43
    @"es.gob.afirma");
    J2OBJC_SET_INITIALIZED(EsGobAfirmaCoreSignersExtraParamsProcessor)
  }
}

@end


#line 45
void EsGobAfirmaCoreSignersExtraParamsProcessor_init(EsGobAfirmaCoreSignersExtraParamsProcessor *self) {
  NSObject_init(self);
}


#line 45
EsGobAfirmaCoreSignersExtraParamsProcessor *new_EsGobAfirmaCoreSignersExtraParamsProcessor_init() {
  J2OBJC_NEW_IMPL(EsGobAfirmaCoreSignersExtraParamsProcessor, init)
}


#line 45
EsGobAfirmaCoreSignersExtraParamsProcessor *create_EsGobAfirmaCoreSignersExtraParamsProcessor_init() {
  J2OBJC_CREATE_IMPL(EsGobAfirmaCoreSignersExtraParamsProcessor, init)
}


#line 59
JavaUtilProperties *EsGobAfirmaCoreSignersExtraParamsProcessor_convertToPropertiesWithNSString_(NSString *entries) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  JavaUtilProperties *params = new_JavaUtilProperties_init();
  if (entries == nil) {
    return params;
  }
  
#line 66
  @try {
    [params load__WithJavaIoInputStream:new_JavaIoByteArrayInputStream_initWithByteArray_([entries java_getBytes])];
  }
  @catch (JavaLangException *e) {
    [((JavaUtilLoggingLogger *) nil_chk(EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER)) warningWithNSString:JreStrcat("$@", @"Se han encontrado entradas no validas en la configuracion de la operacion: ",
#line 71
    e)];
  }
  
#line 75
  return params;
}


#line 97
JavaUtilProperties *EsGobAfirmaCoreSignersExtraParamsProcessor_expandPropertiesWithJavaUtilProperties_(JavaUtilProperties *params) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 98
  return EsGobAfirmaCoreSignersExtraParamsProcessor_expandPropertiesWithJavaUtilProperties_withByteArray_withNSString_(params, nil, nil);
}


#line 122
JavaUtilProperties *EsGobAfirmaCoreSignersExtraParamsProcessor_expandPropertiesWithJavaUtilProperties_withByteArray_withNSString_(JavaUtilProperties *params, IOSByteArray *signedData, NSString *format) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 123
  JavaUtilProperties *p = new_JavaUtilProperties_init();
  {
    IOSObjectArray *a__ =
#line 124
    [((id<JavaUtilSet>) nil_chk([((JavaUtilProperties *) nil_chk(params)) keySet])) toArrayWithNSObjectArray:[IOSObjectArray newArrayWithLength:[params size] type:NSString_class_()]];
    NSString * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    NSString * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      NSString *key = *b__++;
      
#line 125
      (void) [p setPropertyWithNSString:key withNSString:[params getPropertyWithNSString:key]];
    }
  }
  
#line 127
  EsGobAfirmaCoreSignersExtraParamsProcessor_expandPolicyKeysWithJavaUtilProperties_withByteArray_withNSString_(p, signedData, format);
  return p;
}


#line 136
void EsGobAfirmaCoreSignersExtraParamsProcessor_expandPolicyKeysWithJavaUtilProperties_withByteArray_withNSString_(JavaUtilProperties *p, IOSByteArray *signedData, NSString *format) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 137
  if (![((JavaUtilProperties *) nil_chk(p)) containsKeyWithId:EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY]) {
    return;
  }
  
#line 141
  NSString *policyName = [p getPropertyWithNSString:EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY];
  
#line 144
  if (!EsGobAfirmaCoreSignersExtraParamsProcessor_isSupportedPolicyWithNSString_(policyName)) {
    (void) [p removeWithId:EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY];
    @throw new_EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(JreStrcat("$$", @"No se soporta la expansion de atributos para la politica: ", policyName));
  }
  
#line 150
  NSString *normalizedFormat = EsGobAfirmaCoreSignersExtraParamsProcessor_normalizeFormatWithNSString_(format);
  
#line 153
  if ([((NSString *) nil_chk(normalizedFormat)) isEqual:EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_CADES] &&
#line 154
  ([((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE)) isEqual:policyName] ||
#line 155
  [((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE_1_8)) isEqual:policyName])) {
    EsGobAfirmaCoreSignersExtraParamsProcessor_setCAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_withByteArray_(policyName, p, signedData);
  }
  else
#line 159
  if ([normalizedFormat isEqual:EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_XADES] &&
#line 160
  ([((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE)) isEqual:policyName] ||
#line 161
  [((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE_1_8)) isEqual:policyName])) {
    EsGobAfirmaCoreSignersExtraParamsProcessor_setXAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(policyName, p);
  }
  else
#line 165
  if ([normalizedFormat isEqual:EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_PADES] &&
#line 166
  [((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE)) isEqual:policyName]) {
    EsGobAfirmaCoreSignersExtraParamsProcessor_setPAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(policyName, p);
  }
  else {
    
#line 171
    (void) [p removeWithId:EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY];
    @throw new_EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(NSString_java_formatWithNSString_withNSObjectArray_(
#line 173
    @"El formato de firma %1s no esta soportado por la politica %2s", [IOSObjectArray newArrayWithObjects:(id[]){
#line 174
      format, policyName } count:2 type:NSObject_class_()]));
    }
    (void) [p removeWithId:EsGobAfirmaCoreSignersExtraParamsProcessor_EXPANDIBLE_POLICY_KEY];
  }


#line 185
NSString *EsGobAfirmaCoreSignersExtraParamsProcessor_normalizeFormatWithNSString_(NSString *format) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 186
  NSString *normalizedFormat = nil;
  
#line 189
  if ([((NSString *) nil_chk(format)) java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_CADES] ||
#line 190
  [format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_CADES_TRI]) {
    normalizedFormat = EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_CADES;
  }
  else
#line 195
  if ([format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_XADES] ||
#line 196
  [format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_XADES_TRI] ||
#line 197
  [((NSString *) nil_chk([format java_lowercaseStringWithJRELocale:JreLoadStatic(JavaUtilLocale, US)])) java_hasPrefix:JreStrcat("$C", [((NSString *) nil_chk(EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_XADES)) java_lowercaseStringWithJRELocale:JreLoadStatic(JavaUtilLocale, US)], ' ')]) {
    normalizedFormat = EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_XADES;
  }
  else
#line 201
  if ([format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_PDF] ||
#line 202
  [format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_PADES] ||
#line 203
  [format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_PDF_TRI] ||
#line 204
  [format java_equalsIgnoreCase:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_PADES_TRI]) {
    normalizedFormat = EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_PADES;
  }
  return normalizedFormat != nil ? normalizedFormat : format;
}


#line 217
jboolean EsGobAfirmaCoreSignersExtraParamsProcessor_isSupportedPolicyWithNSString_(NSString *policyName) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 218
  return [((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE)) isEqual:policyName] ||
#line 219
  [((NSString *) nil_chk(EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_POLICY_ID_AGE_1_8)) isEqual:policyName];
}


#line 230
void EsGobAfirmaCoreSignersExtraParamsProcessor_setCAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_withByteArray_(NSString *policyName, JavaUtilProperties *params, IOSByteArray *signedData) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 238
  if (![((JavaUtilProperties *) nil_chk(params)) containsKeyWithId:@"mode"] && signedData != nil) {
    (void) [params setPropertyWithNSString:@"mode" withNSString:signedData->size_ < EsGobAfirmaCoreSignersExtraParamsProcessor_SIZE_1MB ?
#line 240
    EsGobAfirmaCoreSignersAOSignConstants_SIGN_MODE_IMPLICIT :
#line 241
    EsGobAfirmaCoreSignersAOSignConstants_SIGN_MODE_EXPLICIT];
  }
  
#line 245
  NSString *profile = [params getPropertyWithNSString:@"profile"];
  if ([((NSString *) nil_chk(EsGobAfirmaCoreSignersAOSignConstants_SIGN_PROFILE_BASELINE)) java_equalsIgnoreCase:profile]) {
    [((JavaUtilLoggingLogger *) nil_chk(EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER)) warningWithNSString:@"Se ignora la configuracion del parametro 'profile' en favor de los requisitos establecidos por la politica de firma"];
  }
  (void) [params setPropertyWithNSString:@"profile" withNSString:EsGobAfirmaCoreSignersAOSignConstants_SIGN_PROFILE_ADVANCED];
  
#line 251
  EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_setPropertiesWithJavaUtilProperties_withNSString_withNSString_(params, policyName, EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_CADES);
}


#line 261
void EsGobAfirmaCoreSignersExtraParamsProcessor_setXAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(NSString *policyName, JavaUtilProperties *params) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 265
  NSString *format = [((JavaUtilProperties *) nil_chk(params)) getPropertyWithNSString:@"format"];
  if (![((NSString *) nil_chk(EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_XADES_DETACHED)) java_equalsIgnoreCase:format] &&
#line 267
  ![((NSString *) nil_chk(EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_XADES_ENVELOPED)) java_equalsIgnoreCase:format]) {
    if (format != nil) {
      [((JavaUtilLoggingLogger *) nil_chk(EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER)) warningWithNSString:@"Se ignora la configuracion del parametro 'format' en favor de los requisitos establecidos por la politica de firma"];
    }
    (void) [params setPropertyWithNSString:@"format" withNSString:EsGobAfirmaCoreSignersAOSignConstants_SIGN_FORMAT_XADES_DETACHED];
  }
  
#line 275
  NSString *profile = [params getPropertyWithNSString:@"profile"];
  if ([((NSString *) nil_chk(EsGobAfirmaCoreSignersAOSignConstants_SIGN_PROFILE_BASELINE)) java_equalsIgnoreCase:profile]) {
    [((JavaUtilLoggingLogger *) nil_chk(EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER)) warningWithNSString:@"Se ignora la configuracion del parametro 'profile' en favor de los requisitos establecidos por la politica de firma"];
  }
  (void) [params setPropertyWithNSString:@"profile" withNSString:EsGobAfirmaCoreSignersAOSignConstants_SIGN_PROFILE_ADVANCED];
  
#line 281
  EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_setPropertiesWithJavaUtilProperties_withNSString_withNSString_(params, policyName, EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_XADES);
}


#line 293
void EsGobAfirmaCoreSignersExtraParamsProcessor_setPAdESPolicyAGEAttributesWithNSString_withJavaUtilProperties_(NSString *policyName, JavaUtilProperties *params) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 298
  if ([((JavaUtilProperties *) nil_chk(params)) containsKeyWithId:@"signatureSubFilter"] &&
#line 299
  ![((NSString *) nil_chk(EsGobAfirmaCoreSignersExtraParamsProcessor_ETSI_CADES_DETACHED)) isEqual:[params getPropertyWithNSString:@"signatureSubFilter"]]) {
    @throw new_EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(JreStrcat("$$C", @"En PAdES con politica firma AGE debe usarse siempre el filtro '",
#line 301
    EsGobAfirmaCoreSignersExtraParamsProcessor_ETSI_CADES_DETACHED, '\''));
  }
  (void) [params setPropertyWithNSString:@"signatureSubFilter" withNSString:EsGobAfirmaCoreSignersExtraParamsProcessor_ETSI_CADES_DETACHED];
  
#line 305
  EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_setPropertiesWithJavaUtilProperties_withNSString_withNSString_(params, policyName, EsGobAfirmaCoreSignersAdESPolicyPropertiesManager_FORMAT_PADES);
}


#line 323
void EsGobAfirmaCoreSignersExtraParamsProcessor_configAutoFormatWithEsGobAfirmaCoreSignersAOSigner_withByteArray_withJavaUtilProperties_(id<EsGobAfirmaCoreSignersAOSigner> signer, IOSByteArray *data, JavaUtilProperties *params) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  NSString *signerClassname = [[((id<EsGobAfirmaCoreSignersAOSigner>) nil_chk(signer)) java_getClass] getName];
  if ([((NSString *) nil_chk(signerClassname)) isEqual:@"es.gob.afirma.signers.pades.AOPDFSigner"]) {
    @try {
      JavaLangReflectMethod *configureMethod = [[signer java_getClass] getMethod:@"configureRespectfulProperties" parameterTypes:[IOSObjectArray newArrayWithObjects:(id[]){ IOSClass_byteArray(1), JavaUtilProperties_class_() } count:2 type:IOSClass_class_()]];
      (void) [((JavaLangReflectMethod *) nil_chk(configureMethod)) invokeWithId:nil withNSObjectArray:[IOSObjectArray newArrayWithObjects:(id[]){ data, params } count:2 type:NSObject_class_()]];
    }
    @catch (JavaLangException *e) {
      [((JavaUtilLoggingLogger *) nil_chk(EsGobAfirmaCoreSignersExtraParamsProcessor_LOGGER)) warningWithNSString:JreStrcat("$@", @"Error al configurar una firma PAdES igual a las existentes: ", e)];
    }
  }
}


#line 351
IOSByteArray *EsGobAfirmaCoreSignersExtraParamsProcessor_loadByteArrayFromExtraParamsWithJavaUtilProperties_withNSString_withBoolean_(JavaUtilProperties *extraParams, NSString *paramName, jboolean secureMode) {
  EsGobAfirmaCoreSignersExtraParamsProcessor_initialize();
  
#line 354
  NSString *value = [((JavaUtilProperties *) nil_chk(extraParams)) getPropertyWithNSString:paramName];
  if (value == nil) {
    @throw new_JavaIoIOException_initWithNSString_(JreStrcat("$$$", @"La propiedad '", paramName, @"' no se encuentra en el extraParams"));
  }
  
#line 359
  IOSByteArray *content;
  if (!secureMode && [value java_length] > 0 && [value java_length] < EsGobAfirmaCoreSignersExtraParamsProcessor_MAX_PATH_SIZE && !EsGobAfirmaCoreMiscBase64_isBase64WithNSString_(value)) {
    @try {
      JavaNetURI *uri = EsGobAfirmaCoreMiscAOUtil_createURIWithNSString_(value);
      {
        JavaIoInputStream *is = EsGobAfirmaCoreMiscAOUtil_loadFileWithJavaNetURI_(
#line 363
        uri);
        JavaLangThrowable *__primaryException1 = nil;
        
#line 363
        @try {
          content = EsGobAfirmaCoreMiscAOUtil_getDataFromInputStreamWithJavaIoInputStream_(is);
        }
        @catch (JavaLangThrowable *e) {
          __primaryException1 = e;
          @throw e;
        }
        @finally {
          if (is != nil) {
            if (__primaryException1 != nil) {
              @try {
                [is close];
              }
              @catch (JavaLangThrowable *e) {
                [__primaryException1 addSuppressedWithJavaLangThrowable:e];
              }
            }
            else {
              [is close];
            }
          }
        }
      }
    }
    @catch (
#line 366
    JavaLangException *e) {
      @throw new_JavaIoIOException_initWithNSString_withJavaLangThrowable_(JreStrcat("$$$", @"El propiedad '", paramName, @"' no contiene una ruta valida a un recurso"), e);
    }
  }
  else {
    content = EsGobAfirmaCoreMiscBase64_decodeWithNSString_(value);
  }
  
#line 374
  return content;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(EsGobAfirmaCoreSignersExtraParamsProcessor)

#line 1 "/Users/desarrolloabamobile/Downloads/pades-ios-mini/src/main/java/es/gob/afirma/core/signers/ExtraParamsProcessor.java"


#line 309
@implementation EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException


#line 313
- (instancetype)initWithNSString:(NSString *)description_ {
  EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(self, description_);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithNSString:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "serialVersionUID", "J", .constantValue.asLong = EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_serialVersionUID, 0x1a, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LNSString;", "LEsGobAfirmaCoreSignersExtraParamsProcessor;" };
  static const J2ObjcClassInfo _EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException = { "IncompatiblePolicyException", "es.gob.afirma.core.signers", ptrTable, methods, fields, 7, 0x19, 1, 1, 1, -1, -1, -1, -1 };
  return &_EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException;
}

@end


#line 313
void EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException *self, NSString *description_) {
  JavaLangException_initWithNSString_(self, description_);
}


#line 313
EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException *new_EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(NSString *description_) {
  J2OBJC_NEW_IMPL(EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException, initWithNSString_, description_)
}


#line 313
EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException *create_EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException_initWithNSString_(NSString *description_) {
  J2OBJC_CREATE_IMPL(EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException, initWithNSString_, description_)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(EsGobAfirmaCoreSignersExtraParamsProcessor_IncompatiblePolicyException)
